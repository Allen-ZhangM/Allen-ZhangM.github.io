<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Go语言学习笔记（五） 函数</title>
  <meta name="description" content="函数定义">
  <meta name="author" content="Wei Wang">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Go语言学习笔记（五） 函数">
  <meta name="twitter:description" content="函数定义">
  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Go语言学习笔记（五） 函数">
  <meta property="og:description" content="函数定义">
  
  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
  <link href="/assets/images/favicon.png" rel="shortcut icon" type="image/png">
  
  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://localhost:4000/2018/04/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94-%E5%87%BD%E6%95%B0/">
  <!--
  <link rel="alternate" type="application/rss+xml" title="Allen Zhang" href="http://localhost:4000/feed.xml">
  -->
  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  
</head>


  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/#blog" title="前往 Allen Zhang 的主页" class="blog-button"><img src="/assets/images/avatar.jpg" width="80" alt="Allen Zhang logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for Allen Zhang" class="blog-button">Allen Zhang</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">一个记录我工作、学习历程的博客</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">新学期，新气象；百尺竿头，更进一步……</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        <p class="panel-cover__description">我不生产知识，只是知识的搬运工</p>
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="Visit blog" class="blog-button">Blog</a></li>
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/Allen-ZhangM" title="@Allen-ZhangM 的 Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  
  
  

  

  <!-- RSS -->
  <!--
  <li class="navigation__item">
    <a href="/feed.xml" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>
	-->

  
  <!-- Email -->
  <li class="navigation__item">
    <a href="mailto:allenzhanglearner@gmail.com" title="Contact me">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>
  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-blue"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2018-04-05 00:00:00 +0800" itemprop="datePublished" class="post-meta__date date">2018-04-05</time> &#8226; <span class="post-meta__tags tags"></span>
    </div>
    <h1 class="post-title">Go语言学习笔记（五） 函数</h1>
  </header>

  <section class="post">
    <h2 id="函数定义">函数定义</h2>

<p>函数构成代码执行的逻辑结构。在Go语言中，函数的基本组成为：关键字func、函数名、参数列表、返回值、函数体和返回语句。</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">p</span><span class="x"> </span><span class="n">mytype</span><span class="p">)</span><span class="x"> </span><span class="n">funcname</span><span class="p">(</span><span class="n">q</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="x"> </span><span class="n">s</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="m">0</span><span class="p">,</span><span class="x"> </span><span class="m">0</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<ul>
  <li>func：保留字func 用于定义一个函数</li>
  <li>(p mytype)：可省略。函数可以定义用于特定的类型，比如这个函数只有mytype类型才可以调用</li>
  <li>funcname：函数的名字</li>
  <li>(q int)：int 类型的变量q 作为输入参数。参数用pass-by-value 方式传递，意味着它们会被复制</li>
  <li>(r,s int)：可省略。变量r和s是这个函数的命名返回值。可以省略返回参数名（int,int）。如果只有一个返回值，可以省略圆括号</li>
  <li>{return 0,0}：函数体以及返回值</li>
</ul>

<h2 id="函数调用">函数调用</h2>

<p>只要事先导入了该函数所在的包，就可以直接按照如下所示的方式调用函数：</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span><span class="x"> </span><span class="s">"mymath"</span><span class="c">// 假设Add被放在一个叫mymath的包中</span><span class="x">
</span><span class="c">// ...</span><span class="x">
</span><span class="n">c</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">mymath</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="x"> </span><span class="m">2</span><span class="p">)</span><span class="x">
</span></code></pre></div></div>

<p>牢记这样的规则：<strong>小写字母开头的函数只在本包内可见，大写字母开头的函数才能被其他包使用。这个规则也适用于类型和变量的可见性。</strong></p>

<h2 id="不定参数"><strong>不定参数</strong></h2>

<p>不定参数类型：形如…type格式的类型只能作为函数的参数类型存在，并且必须是最后一个参数。它是一个语法糖。从内部实现机理上来说，类型…type本质上是一个数组切片，也就是[]type，这也是为什么参数args可以用for循环来获得每个传入的参数。</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">myfunc</span><span class="p">(</span><span class="n">args</span><span class="x"> </span><span class="o">...</span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">for</span><span class="x"> </span><span class="n">_</span><span class="p">,</span><span class="x"> </span><span class="n">arg</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">range</span><span class="x"> </span><span class="n">args</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="x">
    </span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>任意类型的不定参数：可接受任意类型、个数的fmt.Println()方法</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="x"> </span><span class="o">...</span><span class="k">interface</span><span class="p">{})</span><span class="x"> </span><span class="p">(</span><span class="n">n</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="kt">error</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">return</span><span class="x"> </span><span class="n">Fprintln</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">Stdout</span><span class="p">,</span><span class="x"> </span><span class="n">a</span><span class="o">...</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>不定参数的传递：</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">myfunc</span><span class="p">(</span><span class="n">args</span><span class="x"> </span><span class="o">...</span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="c">// 按原样传递</span><span class="x">
    </span><span class="n">myfunc3</span><span class="p">(</span><span class="n">args</span><span class="o">...</span><span class="p">)</span><span class="x">
    </span><span class="c">// 传递片段，实际上任意的int slice都可以传进去</span><span class="x">
    </span><span class="n">myfunc3</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">]</span><span class="o">...</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<h2 id="多返回值">多返回值</h2>

<p>函数或者成员的方法可以有多个返回值，还可以给返回值命名，就像函数的输入参数一样。在函数中执行不带任何参数的return语句时，会返回对应的返回值变量的值。</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="p">(</span><span class="n">file</span><span class="x"> </span><span class="o">*</span><span class="n">File</span><span class="p">)</span><span class="x"> </span><span class="n">Read</span><span class="p">(</span><span class="n">b</span><span class="x"> </span><span class="p">[]</span><span class="kt">byte</span><span class="p">)</span><span class="x"> </span><span class="p">(</span><span class="n">n</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">err</span><span class="x"> </span><span class="n">Error</span><span class="p">)</span><span class="x">
</span></code></pre></div></div>

<p>如果调用方调用了一个具有多返回值的方法，但是却不想关心其中的某个返回值，可以简单地用一个下划线“<em>”来跳过这个返回值，但是不可以只写某一个返回值，下划线“</em>”不可省略：</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span><span class="p">,</span><span class="x"> </span><span class="n">_</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">f</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="x">
</span></code></pre></div></div>

<h2 id="匿名函数">匿名函数</h2>

<p>函数可以像普通变量一样被传递或使用，支持随时在代码里定义匿名函数。</p>

<p>由一个不带函数名的函数声明和函数体组成：</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="x"> </span><span class="n">b</span><span class="x"> </span><span class="kt">int</span><span class="p">,</span><span class="x"> </span><span class="n">z</span><span class="x"> </span><span class="kt">float64</span><span class="p">)</span><span class="x"> </span><span class="kt">bool</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">return</span><span class="x"> </span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="x"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">

</span></code></pre></div></div>

<p>直接赋值给一个变量：</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="x"> </span><span class="n">y</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">return</span><span class="x"> </span><span class="n">x</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">y</span><span class="x">
</span><span class="p">}</span><span class="x">

</span></code></pre></div></div>

<p>直接执行：</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="p">(</span><span class="n">ch</span><span class="x"> </span><span class="k">chan</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
</span><span class="n">ch</span><span class="x"> </span><span class="o">&lt;-</span><span class="x"> </span><span class="n">ACK</span><span class="x">
</span><span class="p">}</span><span class="x"> </span><span class="p">(</span><span class="n">reply_chan</span><span class="p">)</span><span class="x"> </span><span class="c">// 花括号后直接跟参数列表表示函数调用</span><span class="x">
</span></code></pre></div></div>

<h2 id="闭包">闭包</h2>

<p>闭包是可以包含自由（未绑定到特定对象）变量的代码块，这些变量不在这个代码块内或者任何全局上下文中定义，而是在定义代码块的环境中定义。要执行的代码块（由于自由变量包含在代码块中，所以这些自由变量以及它们引用的对象没有被释放）为自由变量提供绑定的计算环境（作用域）。</p>

<p>闭包的价值在于可以作为函数对象或者匿名函数，对于类型系统而言，这意味着不仅要表示数据还要表示代码。支持闭包的多数语言都将函数作为第一级对象，就是说这些函数可以存储到变量中作为参数传递给其他函数，最重要的是能够被函数动态创建和返回。</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span><span class="x"> </span><span class="n">main</span><span class="x">

</span><span class="k">import</span><span class="x"> </span><span class="s">"fmt"</span><span class="x">

</span><span class="k">func</span><span class="x"> </span><span class="n">main</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">var</span><span class="x"> </span><span class="n">f</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="n">Adder</span><span class="p">()</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="x"> </span><span class="s">"-"</span><span class="p">)</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="m">20</span><span class="p">),</span><span class="x"> </span><span class="s">"-"</span><span class="p">)</span><span class="x">
    </span><span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="m">300</span><span class="p">),</span><span class="x"> </span><span class="s">"-"</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="k">func</span><span class="x"> </span><span class="n">Adder</span><span class="p">()</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="p">{</span><span class="x">
    </span><span class="k">var</span><span class="x"> </span><span class="n">x</span><span class="x"> </span><span class="kt">int</span><span class="x">
    </span><span class="k">return</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">delta</span><span class="x"> </span><span class="kt">int</span><span class="p">)</span><span class="x"> </span><span class="kt">int</span><span class="x"> </span><span class="p">{</span><span class="x">
        </span><span class="n">x</span><span class="x"> </span><span class="o">+=</span><span class="x"> </span><span class="n">delta</span><span class="x">
        </span><span class="k">return</span><span class="x"> </span><span class="n">x</span><span class="x">
    </span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
</span><span class="n">输出如下</span><span class="err">：</span><span class="x">
</span><span class="m">1</span><span class="x"> </span><span class="o">-</span><span class="x">
</span><span class="m">21</span><span class="x"> </span><span class="o">-</span><span class="x">
</span><span class="m">321</span><span class="x"> </span><span class="o">-</span><span class="x">

</span></code></pre></div></div>


  </section>
</article>

<section class="read-more">
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">最近的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2018/04/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%85%AD-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/" title="link to Go语言学习笔记（六） 错误处理">Go语言学习笔记（六） 错误处理</a></h2>
       <p class="excerpt">error接口Go语言引入了一个关于错误处理的标准模式，即error接口，该接口的定义如下：type error interface {Error() string}对于大多数函数，如果要返回错误，大致上都可以定义为如下模式，将error作为多种返回值中的最后一个，但这并非是强制要求：func Foo(param int)(n int, err error) {// ...}调用时的代码建议按如下方式处理错误情况：n, err := Foo(0)if err != nil {// 错误处理...&hellip;</p>
       <div class="post-list__meta"><time datetime="2018-04-08 00:00:00 +0800" class="post-list__meta--date date">2018-04-08</time> &#8226; <span class="post-list__meta--tags tags"></span><a class="btn-border-small" href=/2018/04/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%85%AD-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/>继续阅读</a></div>
   </div>
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">更早的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2018/03/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%9B%9B-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="link to Go语言学习笔记（四） 流程控制">Go语言学习笔记（四） 流程控制</a></h2>
       <p class="excerpt">程序设计语言的流程控制语句，用于设定计算执行的次序，建立程序的逻辑结构。可以说，流程控制语句是整个程序的骨架。从根本上讲，流程控制只是为了控制程序语句的执行顺序，一般需要与各种条件配合，因此，在各种流程中，会加入条件判断语句。流程控制语句一般起以下3个作用：  选择，即根据条件跳转到不同的执行序列；  循环，即根据条件反复执行某个序列，当然每一次循环执行的输入输出可能会发生变化；  跳转，即根据条件返回到某执行序列。Go语言支持如下的几种流程控制语句：  条件语句，对应的关键字为if、el...&hellip;</p>
       <div class="post-list__meta"><time datetime="2018-03-27 00:00:00 +0800" class="post-list__meta--date date">2018-03-27</time> &#8226; <span class="post-list__meta--tags tags"></span><a class="btn-border-small" href=/2018/03/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%9B%9B-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/>继续阅读</a></div>
   </div>
   
</section>

<section class="post-comments">
  
    <div id="disqus_thread"></div>
    <script>
    
    var disqus_config = function () {
        this.page.url = "http://localhost:4000/2018/04/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94-%E5%87%BD%E6%95%B0/";
        this.page.identifier = "/2018/04/Go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94-%E5%87%BD%E6%95%B0/";
    };

    var disqus_shortname = 'vno-jekyll';
    
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>要查看<a href="http://disqus.com/?ref_noscript"> Disqus </a>评论，请启用 JavaScript</noscript>
    
  
  
  
  
</section>


            <section class="footer">
<!--
    <footer>
    	<span class="footer__copyright">本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享 署名-非商业性使用-相同方式共享 4.0 国际 许可协议</a></span>
        <span class="footer__copyright">由 <a href="https://jekyllrb.com">Jekyll</a> 于 2018-11-05 生成，感谢 <a href="https://www.digitalocean.com/?refcode=30ed2d146762">Digital Ocean</a> 为本站提供稳定的 VPS 服务</span>
        <span class="footer__copyright">本站由 <a href="http://onev.cat">@onevcat</a> 创建，采用 <a href="https://github.com/onevcat/vno-jekyll">Vno - Jekyll</a> 作为主题，您可以在 GitHub 找到<a href="https://github.com/onevcat/OneV-s-Den">本站源码</a> - &copy; 2018</span>
    </footer>
-->
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/main.js"></script>



    
  </body>

</html>
